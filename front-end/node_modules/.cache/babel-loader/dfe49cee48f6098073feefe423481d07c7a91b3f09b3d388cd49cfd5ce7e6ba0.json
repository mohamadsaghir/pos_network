{"ast":null,"code":"const isBrowser = typeof window !== \"undefined\";\nconst CACHE_KEY = \"payflow:debts-cache\";\nconst QUEUE_KEY = \"payflow:pending-mutations\";\nconst safeParse = (value, fallback) => {\n  if (!value) return fallback;\n  try {\n    return JSON.parse(value);\n  } catch (err) {\n    console.warn(\"Failed to parse offline storage payload:\", err);\n    return fallback;\n  }\n};\nexport const readCache = () => {\n  if (!isBrowser) return {\n    data: [],\n    savedAt: null\n  };\n  return safeParse(localStorage.getItem(CACHE_KEY), {\n    data: [],\n    savedAt: null\n  });\n};\nexport const writeCache = debts => {\n  if (!isBrowser) return;\n  const payload = {\n    data: debts,\n    savedAt: new Date().toISOString()\n  };\n  localStorage.setItem(CACHE_KEY, JSON.stringify(payload));\n};\nexport const updateCache = updater => {\n  if (!isBrowser) return;\n  const snapshot = readCache();\n  const current = Array.isArray(snapshot === null || snapshot === void 0 ? void 0 : snapshot.data) ? snapshot.data : [];\n  const next = updater(current.slice());\n  writeCache(next);\n  return next;\n};\nexport const readQueue = () => {\n  if (!isBrowser) return [];\n  return safeParse(localStorage.getItem(QUEUE_KEY), []);\n};\nexport const writeQueue = queue => {\n  if (!isBrowser) return;\n  localStorage.setItem(QUEUE_KEY, JSON.stringify(queue));\n};\nexport const enqueueMutation = mutation => {\n  if (!isBrowser) return;\n  const queue = readQueue();\n  queue.push({\n    ...mutation,\n    queuedAt: new Date().toISOString()\n  });\n  writeQueue(queue);\n};\nexport const isLikelyNetworkError = error => {\n  if (typeof navigator !== \"undefined\" && !navigator.onLine) return true;\n  if (!error) return false;\n  if (error.code === \"ERR_NETWORK\") return true;\n  if (error.message && /Network Error/i.test(error.message)) return true;\n  if (error.request && !error.response) return true;\n  return false;\n};\nexport const onOnline = cb => {\n  if (!isBrowser || typeof cb !== \"function\") return;\n  window.addEventListener(\"online\", cb);\n};","map":{"version":3,"names":["isBrowser","window","CACHE_KEY","QUEUE_KEY","safeParse","value","fallback","JSON","parse","err","console","warn","readCache","data","savedAt","localStorage","getItem","writeCache","debts","payload","Date","toISOString","setItem","stringify","updateCache","updater","snapshot","current","Array","isArray","next","slice","readQueue","writeQueue","queue","enqueueMutation","mutation","push","queuedAt","isLikelyNetworkError","error","navigator","onLine","code","message","test","request","response","onOnline","cb","addEventListener"],"sources":["C:/Users/moham/Desktop/offline-sub-clean/front-end/src/utils/offline.js"],"sourcesContent":["const isBrowser = typeof window !== \"undefined\";\n\nconst CACHE_KEY = \"payflow:debts-cache\";\nconst QUEUE_KEY = \"payflow:pending-mutations\";\n\nconst safeParse = (value, fallback) => {\n  if (!value) return fallback;\n  try {\n    return JSON.parse(value);\n  } catch (err) {\n    console.warn(\"Failed to parse offline storage payload:\", err);\n    return fallback;\n  }\n};\n\nexport const readCache = () => {\n  if (!isBrowser) return { data: [], savedAt: null };\n  return safeParse(localStorage.getItem(CACHE_KEY), { data: [], savedAt: null });\n};\n\nexport const writeCache = (debts) => {\n  if (!isBrowser) return;\n  const payload = {\n    data: debts,\n    savedAt: new Date().toISOString(),\n  };\n  localStorage.setItem(CACHE_KEY, JSON.stringify(payload));\n};\n\nexport const updateCache = (updater) => {\n  if (!isBrowser) return;\n  const snapshot = readCache();\n  const current = Array.isArray(snapshot?.data) ? snapshot.data : [];\n  const next = updater(current.slice());\n  writeCache(next);\n  return next;\n};\n\nexport const readQueue = () => {\n  if (!isBrowser) return [];\n  return safeParse(localStorage.getItem(QUEUE_KEY), []);\n};\n\nexport const writeQueue = (queue) => {\n  if (!isBrowser) return;\n  localStorage.setItem(QUEUE_KEY, JSON.stringify(queue));\n};\n\nexport const enqueueMutation = (mutation) => {\n  if (!isBrowser) return;\n  const queue = readQueue();\n  queue.push({\n    ...mutation,\n    queuedAt: new Date().toISOString(),\n  });\n  writeQueue(queue);\n};\n\nexport const isLikelyNetworkError = (error) => {\n  if (typeof navigator !== \"undefined\" && !navigator.onLine) return true;\n  if (!error) return false;\n  if (error.code === \"ERR_NETWORK\") return true;\n  if (error.message && /Network Error/i.test(error.message)) return true;\n  if (error.request && !error.response) return true;\n  return false;\n};\n\nexport const onOnline = (cb) => {\n  if (!isBrowser || typeof cb !== \"function\") return;\n  window.addEventListener(\"online\", cb);\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}